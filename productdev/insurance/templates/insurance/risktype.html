<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<div id="app" class="container">
    <div v-for="(risktype, index) in risktypes">
        <h2>[[ risktype['Insurance Type'] ]]</h2>
        <form class="needs-validation">
            <div v-for="(value, propertyName) in risktype.Data">
                <label :for="propertyName + '_' + index">[[ propertyName ]]</label>
                <input v-if="!Array.isArray(value)" :type="value" :name="propertyName + '_' + index" :id="propertyName + '_' + index" value="" class="form-control">
                <select v-else :name="propertyName + '_' + index" :id="propertyName + '_' + index" class="form-control">
                    <option v-for="opt in value" :value="opt">[[ opt ]]</option>
                </select>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript">
    new Vue({
        delimiters: ['[[', ']]'],
        el: '#app',
        created() {
            this.fetchData();
        },
        data: {
            risktypes: []
        },
        methods: {
            fetchData() {
                axios.get('{{ api_url_path }}').then(
                    response => {
                        this.risktypes = response.data.results;
                        console.log(this.risktypes)
                    }
                );
            }
        }
    });

</script>
